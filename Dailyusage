az monitor diagnostic-settings create \
  --name "pg-monitoring" \
  --resource "/subscriptions/xxxx-xxxx-xxxx/resourceGroups/my-rg/providers/Microsoft.DBforPostgreSQL/flexibleServers/my-flex-server" \
  --workspace "/subscriptions/xxxx-xxxx-xxxx/resourceGroups/monitoring-rg/providers/Microsoft.OperationalInsights/workspaces/my-workspace" \
  --logs '[{"category": "PostgreSQLLogs", "enabled": true}, {"category": "QueryStoreRuntimeStatistics", "enabled": true}, {"category": "QueryStoreWaitStatistics", "enabled": true}, {"category": "PostgreSQLSessions", "enabled": true}]' \
  --metrics '[{"category": "AllMetrics", "enabled": true}]'
